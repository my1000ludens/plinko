<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>My 1000 Ludens</title>
    
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <script type="module" crossorigin>
var b=Object.defineProperty;var k=(n,s,t)=>s in n?b(n,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[s]=t;var r=(n,s,t)=>(k(n,typeof s!="symbol"?s+"":s,t),t);(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const e of o)if(e.type==="childList")for(const h of e.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function t(o){const e={};return o.integrity&&(e.integrity=o.integrity),o.referrerpolicy&&(e.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?e.credentials="include":o.crossorigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function i(o){if(o.ep)return;o.ep=!0;const e=t(o);fetch(o.href,e)}})();class C{constructor(s,t){r(this,"x");r(this,"y");r(this,"alive",!0);this.x=s,this.y=t}isOutOfScreen(s,t){return this.x<0||this.x>s||this.y<0||this.y>t}update(s){throw new Error("Not implemented")}render(s){throw new Error("Not implemented")}destroy(){this.alive=!1}}const y=.125,L=.7;class p extends C{constructor(t,i,o=0,e=0,h=0,d=0,c=10){super(t,i);r(this,"dx");r(this,"dy");r(this,"ddx");r(this,"ddy");r(this,"radius");this.x=t,this.y=i,this.dx=o,this.dy=e,this.ddx=h,this.ddy=d,this.radius=c}force(t,i){return this.ddx+=t,this.ddy+=i,this}willCollideWith(t,i){const o=this.x+this.dx*t,e=this.y+this.dy*t,h=i.x+i.dx*t,d=i.y+i.dy*t;return Math.sqrt((o-h)**2+(e-d)**2)<=this.radius+i.radius}collideWith(t,i){if(this.willCollideWith(t,i)){const o=Math.sqrt((this.x-i.x)**2+(this.y-i.y)**2),[e,h]=[this.x-i.x,this.y-i.y],[d,c]=[e/o,h/o],[a,l]=[this.dx,this.dy],[u,w]=[i.dx,i.dy],g=(a*d+l*c)*L,x=(u*d+w*c)*L,[E,A]=[g*d,g*c],[z,S]=[x*d,x*c],[W,M]=[a-E*2,l-A*2],[O,v]=[u-z*2,w-S*2];this.dx=W,this.dy=M,i.dx=O,i.dy=v}return this}update(t){this.x+=this.dx*t,this.y+=this.dy*t,this.dx+=this.ddx*t,this.dy+=this.ddy*t}render(t){throw new Error("Not implemented")}}class I extends p{constructor(t,i,o){super(t,i,0,0,0,0,o);r(this,"radius");r(this,"audio");r(this,"duration");this.x=t,this.y=i,this.radius=o,this.audio=new Audio("./B.wav"),this.audio.volume=.1,this.duration=0}collideWith(t,i){return this.willCollideWith(t,i)&&this.audio.readyState===4&&(this.duration=1),super.collideWith(t,i)}update(t){super.update(t),this.duration-=t,this.duration<0&&(this.duration=0)}render(t){t.beginPath(),t.fillStyle="#cccccc",t.arc(this.x,this.y,this.radius+this.radius*this.duration*this.duration,0,2*Math.PI),t.fill(),t.closePath(),t.beginPath(),t.fillStyle="#000000",t.arc(this.x,this.y,this.radius,0,2*Math.PI),t.fill(),t.closePath()}}class m extends p{constructor(t,i,o,e){super(t,i);r(this,"gap");r(this,"rows");r(this,"radius");r(this,"pinList");this.rows=o,this.pinList=[];const h=B(o);this.gap=e/(o+1),this.radius=this.gap*y;let d=3,c=d,[a,l]=[t-this.gap,i];for(let u=0;u<h;u++)this.pinList.push(new I(a,l,this.radius)),a+=this.gap,c-=1,c===0&&(d++,c=d,a=a-this.gap*d+this.gap/2,l=l+this.gap*Math.sqrt(3)/2)}collideWith(t,i){return this.pinList.forEach(o=>o.collideWith(t,i)),this}update(t){this.pinList.forEach(i=>i.update(t))}render(t){this.pinList.forEach(i=>i.render(t))}}const B=n=>{if(n<0)throw new Error("Rows must be positive");return(n+5)*n/2};class f extends p{constructor(s,t,i=10){super(s,t,0,0,0,0,i)}render(s){s.beginPath(),s.arc(this.x,this.y,this.radius,0,2*Math.PI),s.fillStyle="rgba(150, 150, 150, 0.8)",s.fill(),s.closePath()}}class N extends p{constructor(t,i,o){super(t,i);r(this,"count");r(this,"size");r(this,"audio");this.count=0,this.size=o,this.audio=new Audio("./AA.wav")}willCollideWith(t,i){return i.x+i.radius>this.x-this.size*.5&&i.x-i.radius<this.x+this.size*.5&&i.y+i.radius>this.y-this.size*.5&&i.y-i.radius<this.y+this.size*.5}collideWith(t,i){return this.willCollideWith(t,i)&&this.audio.readyState===4&&(this.count+=1,i.destroy()),this}render(t){t.beginPath(),t.roundRect(this.x-this.size*.5,this.y-this.size*.5,this.size,this.size,Math.sqrt(this.size)),t.fillStyle="#999999",t.fill(),t.fillStyle="#000000",t.font="20px Arial",t.fillText(this.count.toString(),this.x,this.y+this.size,this.size),t.closePath()}}class P extends p{constructor(t,i,o,e){super(t,i);r(this,"coinPocketList");this.coinPocketList=[];const h=o*(1-y*2),d=o*y;let[c,a]=[t-o*e/2+d+h/2,i];for(let l=0;l<e;l++)this.coinPocketList.push(new N(c,a,h)),c+=o}collideWith(t,i){return this.coinPocketList.forEach(o=>o.collideWith(t,i)),this}render(t){this.coinPocketList.forEach(i=>i.render(t))}}class q{constructor(s){r(this,"atomList");r(this,"ctx");this.atomList=[],this.ctx=s}run(){let t=performance.now();const i=async()=>{const o=performance.now(),e=Math.min(o-t,200);t+=e;for(let h=0;h<e/5;h++)this.update(5/1e3);this.render(this.ctx),requestAnimationFrame(i)};requestAnimationFrame(i)}add(s){this.atomList.push(s)}sub(s){this.atomList=this.atomList.filter(t=>t!==s)}update(s){this.atomList=this.atomList.filter(e=>e.alive),this.atomList=this.atomList.filter(e=>!e.isOutOfScreen(this.ctx.canvas.width,this.ctx.canvas.height));const t=this.atomList.find(e=>e instanceof m),i=this.atomList.find(e=>e instanceof P),o=this.atomList.filter(e=>e instanceof f);o.forEach(e=>t.collideWith(s,e)),o.forEach(e=>i.collideWith(s,e)),this.atomList.forEach(e=>e.update(s))}render(s){s.clearRect(0,0,s.canvas.width,s.canvas.height),this.atomList.forEach(t=>t.render(s))}}const R=n=>{const{width:s,height:t}=window.getComputedStyle(n);n.width=parseInt(s)*2,n.height=parseInt(t)*2};(()=>{const n=document.getElementById("app");R(n);const s=n.width,t=n.height,i=n.getContext("2d"),o=new q(i);o.run();const e=new m(s*.5,t*.3,10,s*.8),h=new P(s*.5,e.pinList.slice(-1)[0].y+e.gap/2,e.gap,e.rows+1);o.add(e),o.add(h),new Array(1e3).fill("").forEach((d,c)=>o.add(new f(s*.5+e.gap*(c/1e3-.5),e.pinList[0].y-e.gap,e.radius*2).force(0,Math.pow(e.radius,3)))),window.addEventListener("keydown",d=>{d.keyCode===32&&(o.add(new f(s*.5+-.45*s*.05,t*.27,e.radius*2).force(0,Math.pow(e.radius,3))),o.add(new f(s*.5+.45*s*.05,t*.27,e.radius*2).force(0,Math.pow(e.radius,3))))})})();

</script>
    <style>
body{font-family:-apple-system,BlinkMacSystemFont,sans-serif}#app{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:100vw;height:140vw;max-width:50rem;max-height:70rem}

</style>
  </head>
  <body>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-QY8Q10SGTD"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag('js', new Date());

      gtag('config', 'G-QY8Q10SGTD');
    </script>
    <canvas id="app"></canvas>
    
  </body>
</html>
